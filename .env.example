# ============================================================================
# Tale Platform - Environment Configuration
# ============================================================================
# Copy this file to .env and fill in your values
# Generate secrets with: openssl rand -base64 32 (for base64) or openssl rand -hex 32 (for hex)

# ============================================================================
# REQUIRED: Domain Configuration
# ============================================================================
# HOST: Hostname only, without protocol (used for Docker networking, emails)
# SITE_URL: Full canonical URL with protocol (used for external links, auth callbacks)
#
# Examples:
#   Production:
#     HOST=demo.tale.dev
#     SITE_URL=https://demo.tale.dev
#   Development:
#     HOST=tale.local
#     SITE_URL=https://tale.local
HOST=tale.local
SITE_URL=https://tale.local

# ============================================================================
# OPTIONAL: TLS/SSL Configuration
# ============================================================================
# TLS_MODE: Choose how SSL certificates are handled
#   - "selfsigned" (default): Self-signed certificates for development
#     Browser will show certificate warning (expected behavior)
#     To trust certs on host: docker exec tale-proxy caddy trust
#   - "letsencrypt": Free trusted certificates from Let's Encrypt
#     For production. Requires valid public domain and ports 80/443 accessible.
#
# TLS_EMAIL: Email for Let's Encrypt notifications (optional but recommended)
#
# Development (default):
TLS_MODE=selfsigned
#
# Production example:
# TLS_MODE=letsencrypt
# TLS_EMAIL=admin@yourdomain.com

# ============================================================================
# REQUIRED: Security Secrets
# ============================================================================
# Generate with: openssl rand -base64 32
BETTER_AUTH_SECRET=SB53GlYc8RaMU+stOmOWXtRU8JEyOQItpBNK5b03Aco=
# Generate with: openssl rand -hex 32
ENCRYPTION_SECRET_HEX=3143246f44def075d40141fb849faffcf409fbbeb7a282a3a7c2f4396f2ed232

# ============================================================================
# REQUIRED: API Keys
# ============================================================================
# OpenRouter API configuration (recommended). Get your API key at https://openrouter.ai
# EMBEDDING_DIMENSIONS controls the embedding vector size used by RAG/vector search.
# When using custom embedding models or providers, you MUST set EMBEDDING_DIMENSIONS
# to match your vector store's configured dimension (for example, 3072 for
# text-embedding-3-large).
OPENAI_BASE_URL=https://openrouter.ai/api/v1
OPENAI_API_KEY=your-openrouter-api-key
OPENAI_MODEL=moonshotai/kimi-k2-thinking
# Fast model for sub-agents. MUST be a non-thinking model (no reasoning tokens).
# Thinking models may cause issues with tool calling and streaming.
OPENAI_FAST_MODEL=qwen/qwen3-next-80b-a3b-instruct
OPENAI_CODING_MODEL=openai/gpt-5.2
OPENAI_EMBEDDING_MODEL=qwen/qwen3-embedding-4b
# Vision model for image analysis (defaults to OPENAI_MODEL if not set)
# Recommended: qwen/qwen3-vl-32b-instruct (high quality vision model)
# Alternative: openai/gpt-4o (higher quality but more expensive)
OPENAI_VISION_MODEL=qwen/qwen3-vl-32b-instruct
# BAML model for knowledge graph extraction (defaults to OPENAI_MODEL if not set)
# Use a non-thinking model to avoid JSON truncation issues with reasoning models
# BAML_LLM_MODEL=deepseek/deepseek-v3.2
EMBEDDING_DIMENSIONS=2560

# ============================================================================
# OPTIONAL: Database Configuration
# ============================================================================
# Database password for self-hosted PostgreSQL (auto-used by all services)
# Change this password in production
DB_PASSWORD=tale_password_change_me

# Advanced: Override the auto-generated database connection URL
# If not set, POSTGRES_URL is constructed as postgresql://tale:${DB_PASSWORD}@db:5432
# Note: Convex expects URL without database name; DB name derived from INSTANCE_NAME
# POSTGRES_URL=postgresql://user:password@host:port

# ============================================================================
# OPTIONAL: Convex Instance Configuration
# ============================================================================
# Generate with: openssl rand -hex 32
INSTANCE_SECRET=0516d5cddc8b9bbc01238b8696f13c711983f45f6dc4dbf9dc66ba42fc16f504

# ============================================================================
# OPTIONAL: Error Tracking (Sentry)
# ============================================================================
# Get your DSN from https://sentry.io or use a self-hosted alternative
# (GlitchTip, Bugsink) with a compatible DSN format.
# If not set, error tracking is disabled.
# SENTRY_DSN=https://your-key@your-sentry-host/project-id

# ============================================================================
# OPTIONAL: Operator Service (Browser Automation)
# ============================================================================
# URL of the Operator service for web browser automation tasks.
# The Operator uses Playwright + AI for intelligent web interactions.
# If not set, defaults to http://localhost:8004
# OPERATOR_URL=http://operator:8004
