{
  "name": "gmail",
  "title": "Gmail",
  "description": "Google Gmail API integration for email, labels, threads, and drafts",
  "version": 2,
  "authMethod": "oauth2",
  "supportedAuthMethods": ["oauth2"],
  "secretBindings": ["accessToken"],
  "allowedHosts": ["gmail.googleapis.com", "www.googleapis.com"],
  "oauth2Config": {
    "authorizationUrl": "https://accounts.google.com/o/oauth2/v2/auth",
    "tokenUrl": "https://oauth2.googleapis.com/token",
    "scopes": [
      "https://www.googleapis.com/auth/gmail.readonly",
      "https://www.googleapis.com/auth/gmail.send",
      "https://www.googleapis.com/auth/gmail.labels",
      "https://www.googleapis.com/auth/gmail.modify"
    ]
  },
  "operations": [
    {
      "name": "list_messages",
      "title": "List Messages",
      "description": "List message IDs and thread IDs from the mailbox, optionally filtered by Gmail search query or label",
      "parametersSchema": {
        "type": "object",
        "properties": {
          "q": { "type": "string", "description": "Gmail search query (same syntax as the Gmail search box, e.g. \"from:user@example.com is:unread\")", "required": false },
          "maxResults": { "type": "number", "description": "Maximum number of messages to return (max 500, default 25)", "required": false },
          "pageToken": { "type": "string", "description": "Page token from a previous list request for pagination", "required": false },
          "labelIds": { "type": "string", "description": "Comma-separated label IDs to filter by (e.g. \"INBOX\", \"UNREAD\", \"STARRED\")", "required": false }
        }
      }
    },
    {
      "name": "get_message",
      "title": "Get Message",
      "description": "Fetch a single email message by ID with full headers, body, and attachment metadata. Optionally download all attachments.",
      "parametersSchema": {
        "type": "object",
        "properties": {
          "messageId": { "type": "string", "description": "The message ID returned from list_messages or search_messages", "required": true },
          "format": { "type": "string", "description": "Response format: full (default, includes parsed body), metadata (headers only), minimal (IDs only), or raw (RFC 2822)", "required": false },
          "includeAttachments": { "type": "boolean", "description": "When true, downloads and stores all file attachments. Each attachment is stored and returned with a fileId and URL.", "required": false }
        }
      }
    },
    {
      "name": "get_attachments",
      "title": "Get Message Attachments",
      "description": "Download all file attachments from a message and store them. Returns fileId and URL for each attachment.",
      "parametersSchema": {
        "type": "object",
        "properties": {
          "messageId": { "type": "string", "description": "The message ID containing the attachments", "required": true }
        }
      }
    },
    {
      "name": "search_messages",
      "title": "Search Messages",
      "description": "Search messages using Gmail query syntax and return matching message IDs",
      "parametersSchema": {
        "type": "object",
        "properties": {
          "query": { "type": "string", "description": "Gmail search query (e.g. \"subject:invoice after:2025/01/01 has:attachment\")", "required": true },
          "maxResults": { "type": "number", "description": "Maximum number of results to return (max 500, default 25)", "required": false },
          "pageToken": { "type": "string", "description": "Page token from a previous search for pagination", "required": false }
        }
      }
    },
    {
      "name": "send_message",
      "title": "Send Message",
      "description": "Compose and send an email message via Gmail. Supports replying to a thread and sending with file attachments.",
      "operationType": "write",
      "requiresApproval": true,
      "parametersSchema": {
        "type": "object",
        "properties": {
          "to": { "type": "string", "description": "Recipient email address (e.g. \"user@example.com\")", "required": true },
          "subject": { "type": "string", "description": "Email subject line", "required": true },
          "body": { "type": "string", "description": "Email body content", "required": false },
          "cc": { "type": "string", "description": "CC recipient email address", "required": false },
          "bcc": { "type": "string", "description": "BCC recipient email address", "required": false },
          "contentType": { "type": "string", "description": "Body content type: \"text/plain\" (default) or \"text/html\"", "required": false },
          "threadId": { "type": "string", "description": "Thread ID to reply to (from a previous message's threadId). Gmail will group the message into the same conversation.", "required": false },
          "inReplyTo": { "type": "string", "description": "RFC 2822 Message-ID of the message being replied to (e.g. \"<CABx...@mail.gmail.com>\"). Sets the In-Reply-To MIME header.", "required": false },
          "references": { "type": "string", "description": "Space-separated list of Message-IDs for the References MIME header. If omitted, inReplyTo value is used.", "required": false },
          "attachments": { "type": "array", "description": "Array of file attachments, each with name (string), contentType (string), and url (Convex file storage URL)", "required": false }
        }
      }
    },
    {
      "name": "list_labels",
      "title": "List Labels",
      "description": "List all labels in the mailbox including system labels (INBOX, SENT, etc.) and user-created labels",
      "parametersSchema": {
        "type": "object",
        "properties": {}
      }
    },
    {
      "name": "get_thread",
      "title": "Get Thread",
      "description": "Fetch a complete email thread (conversation) with all messages",
      "parametersSchema": {
        "type": "object",
        "properties": {
          "threadId": { "type": "string", "description": "The thread ID to retrieve", "required": true },
          "format": { "type": "string", "description": "Response format: full (default), metadata, minimal, or email (maps to standard email type with from/to/subject/text/html/attachments/conversationId/direction)", "required": false }
        }
      }
    },
    {
      "name": "list_drafts",
      "title": "List Drafts",
      "description": "List draft messages in the mailbox",
      "parametersSchema": {
        "type": "object",
        "properties": {
          "maxResults": { "type": "number", "description": "Maximum number of drafts to return (max 500, default 25)", "required": false },
          "pageToken": { "type": "string", "description": "Page token from a previous list request for pagination", "required": false }
        }
      }
    },
    {
      "name": "get_attachment",
      "title": "Get Attachment",
      "description": "Download a single email attachment by message ID and attachment ID, storing it via file storage",
      "parametersSchema": {
        "type": "object",
        "properties": {
          "messageId": { "type": "string", "description": "The message ID containing the attachment", "required": true },
          "attachmentId": { "type": "string", "description": "The attachment ID from the message payload", "required": true }
        }
      }
    }
  ]
}
